<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>4-DOF Model - ToneLab</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="page-shell">
    <header class="hero">
      <div class="hero-text">
        <h1>Low-Frequency DOF Model</h1>
        <p>Tune the coupled degrees of freedom directly. Use the cards to edit physical parameters, then preview the model response.</p>
      </div>
      <div class="hero-actions">
        <div class="mode-tabs" role="tablist">
          <button class="tab-btn" data-order="1">1-DOF</button>
          <button class="tab-btn" data-order="2">2-DOF</button>
          <button class="tab-btn" data-order="3">3-DOF</button>
          <button class="tab-btn tab-btn-active" data-order="4">4-DOF</button>
        </div>
      </div>
    </header>

    <section class="card-surface">
      <div class="plot-header dof-frf-header">
        <div>
          <h2>Frequency Response</h2>
          <p class="muted small">Solid line shows current model solution. Dashed line shows Target overlay.</p>
        </div>
        <label class="toggle">
          <input type="checkbox" id="toggle_overlay">
          <span class="toggle-label">Compare</span>
          <span class="toggle-knob"></span>
        </label>
      </div>
      <div class="plot-shell">
        <div id="plot_dof" class="plot"></div>
        <div id="plot_overlay" class="plot-overlay"></div>
      </div>

      <div class="section-divider"></div>

      <div class="lfs-header dof-modes-header">
        <div>
          <h2>Modes</h2>
          <p class="muted small">Edit physical parameters for each degree of freedom.</p>
        </div>
      </div>

      <div class="mode-grid" id="dof_cards">
        <!-- populated by script -->
      </div>

      <div class="plot-footer">
        <div class="muted">Model order <span id="model_order_label">4</span> · Derived from shared 4-DOF solver core</div>
        <div class="link-row">
          <span class="small muted">Blue = current · Gold dashed = Target</span>
        </div>
      </div>

      <section class="dof-fit-panel" aria-label="Fit model to target frequencies">
        <div class="dof-fit-copy">
          <h3>Fit My Guitar</h3>
          <p class="muted small">Enter target mode frequencies and solve toward those targets.</p>
        </div>
        <div class="dof-fit-controls">
          <label class="dof-fit-field">
            <span>Air (Hz)</span>
            <input id="fit_target_air" type="number" min="50" max="140" step="0.1" inputmode="decimal" placeholder="100">
          </label>
          <label class="dof-fit-field">
            <span>Top (Hz)</span>
            <input id="fit_target_top" type="number" min="120" max="240" step="0.1" inputmode="decimal" placeholder="185">
          </label>
          <label class="dof-fit-field">
            <span>Back (Hz)</span>
            <input id="fit_target_back" type="number" min="180" max="300" step="0.1" inputmode="decimal" placeholder="230">
          </label>
          <label class="dof-fit-field">
            <span>Top Effective Mass (g)</span>
            <input id="fit_target_mass_top" type="number" min="5" max="120" step="0.1" inputmode="decimal" placeholder="43">
          </label>
          <label class="dof-fit-field">
            <span>Top Effective Stiffness (N/m)</span>
            <input id="fit_target_stiffness_top" type="number" min="10000" max="150000" step="100" inputmode="decimal" placeholder="42700">
          </label>
          <button id="btn_fit_guitar" class="ghost-btn btn-small" type="button">Fit My Guitar</button>
          <button id="btn_fit_guitar_fast" class="ghost-btn btn-small" type="button">Fit 2</button>
          <button id="btn_fit_guitar_measured" class="ghost-btn btn-small" type="button">Fit 3</button>
          <button id="btn_fit_clear" class="ghost-btn btn-small" type="button">Clear</button>
        </div>
        <p id="fit_status" class="muted small dof-fit-status"></p>
      </section>
    </section>
  </div>

  <script src="../vendor/plotly/plotly.min.js" defer></script>
  <script src="../common/atmosphere.js" defer></script>
  <script src="../common/dof_solver_adapter.js" defer></script>
  <script src="../common/overlay_segments.js" defer></script>
  <script src="../common/solver_core.js" defer></script>
  <script src="../common/4dof/model_core.js" defer></script>
  <script src="main.js" defer></script>
</body>

</html>
